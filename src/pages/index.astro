---
import "../styles/global.css";
import NoticeBuilder from "../components/NoticeBuilder";
import SeoHead from "../components/SeoHead.astro";
import { getBuildingOptions } from "../data/buildings";
import { parseBuildingKeys } from "../lib/access";

const env = Astro.locals.runtime?.env ?? {};
const buildingKeys = parseBuildingKeys(env.BUILDING_KEYS_JSON);
const buildingOptions = getBuildingOptions(buildingKeys);
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <SeoHead
      title="Building Ledger | Resident issue tracker and notice builder"
      description="Track building repair issues, add me too reports, and create neutral notice drafts with simple forms."
      canonicalPath="/"
    />
  </head>
  <body>
    <main class="page" id="main">
      <section class="panel panel-highlight home-intro-panel" aria-labelledby="home-title">
        <div class="home-intro-copy">
          <p class="eyebrow">Building ledger</p>
          <h1 id="home-title">Resident issue tracker</h1>
          <p class="helper">Keep a private record of repair issues in your building.</p>
          <p class="helper">Use short facts and dates. Do not include names or unit numbers.</p>
        </div>
        <ul class="home-intro-list" aria-label="How it works">
          <li>Create one issue.</li>
          <li>Add “Me too”.</li>
          <li>Generate a neutral notice.</li>
        </ul>
      </section>

      <NoticeBuilder
        client:load
        buildingOptions={buildingOptions}
      />
    </main>
  </body>
</html>
