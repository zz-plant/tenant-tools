---
import "../styles/global.css";
import NoticeBuilder from "../components/NoticeBuilder";
import SeoHead from "../components/SeoHead.astro";
import { getBuildingOptions } from "../data/buildings";
import { parseBuildingKeys } from "../lib/access";

const env = Astro.locals.runtime?.env ?? {};
const buildingKeys = parseBuildingKeys(env.BUILDING_KEYS_JSON);
const buildingOptions = getBuildingOptions(buildingKeys);
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <SeoHead
      title="Building Ledger | Resident issue tracker and notice builder"
      description="Track building repair issues, add me too reports, and create neutral notice drafts with simple forms."
      canonicalPath="/"
    />
  </head>
  <body>
    <main class="page" id="main">
      <section class="panel panel-highlight" aria-labelledby="home-title">
        <p class="eyebrow">Building ledger</p>
        <h1 id="home-title">Resident issue tracker</h1>
        <p class="helper">Keep a private record of repair issues in your building.</p>
        <p class="helper">Use short facts and dates. Do not include names or unit numbers.</p>
      </section>

      <section class="panel" aria-labelledby="home-how-it-works">
        <h2 id="home-how-it-works">How it works</h2>
        <ul class="helper-list">
          <li>Create an issue with simple fields.</li>
          <li>Add “Me too” to show how many residents are affected.</li>
          <li>Generate a neutral repair notice with standard or very simple English.</li>
        </ul>
      </section>

      <NoticeBuilder
        client:load
        buildingOptions={buildingOptions}
      />
    </main>
  </body>
</html>
